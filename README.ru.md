<p align="center">
  <img src="https://raw.githubusercontent.com/hteppl/remnawave-cloudflare-nodes/master/.github/images/logo.png" alt="remnawave-cloudflare-nodes" width="800px">
</p>

## remnawave-cloudflare-nodes

<p align="left">
  <a href="https://github.com/hteppl/remnawave-cloudflare-nodes/releases/"><img src="https://img.shields.io/github/v/release/hteppl/remnawave-cloudflare-nodes.svg" alt="Release"></a>
  <a href="https://hub.docker.com/r/hteppl/remnawave-cloudflare-nodes/"><img src="https://img.shields.io/badge/DockerHub-remnawave--cloudflare--nodes-blue" alt="DockerHub"></a>
  <a href="https://github.com/hteppl/remnawave-cloudflare-nodes/actions"><img src="https://img.shields.io/github/actions/workflow/status/hteppl/remnawave-cloudflare-nodes/dockerhub-publish.yaml" alt="Build"></a>
  <a href="https://www.python.org/"><img src="https://img.shields.io/badge/python-3.12-blue.svg" alt="Python 3.12"></a>
  <a href="https://opensource.org/licenses/GPL-3.0"><img src="https://img.shields.io/badge/license-GPLv3-green.svg" alt="License: GPL v3"></a>
</p>

[English](README.md) | –†—É—Å—Å–∫–∏–π

–°–µ—Ä–≤–∏—Å –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è DNS-–∑–∞–ø–∏—Å—è–º–∏ Cloudflare –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è –Ω–æ–¥ Remnawave (https://docs.rw).

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–æ–¥** - –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –Ω–æ–¥ —á–µ—Ä–µ–∑ Remnawave API
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ DNS** - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ A-–∑–∞–ø–∏—Å–µ–π
- **–ê–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–æ–Ω** - –ü–æ–ª—É—á–µ–Ω–∏–µ Zone ID –ø–æ –∏–º–µ–Ω–∏ –¥–æ–º–µ–Ω–∞
- **–ú—É–ª—å—Ç–∏–¥–æ–º–µ–Ω–Ω–æ—Å—Ç—å** - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –¥–æ–º–µ–Ω–æ–≤ –∏ –∑–æ–Ω
- **Telegram-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** - –û–ø–æ–≤–µ—â–µ–Ω–∏—è –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞ –Ω–æ–¥, DNS –∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–æ–±—ã—Ç–∏—è—Ö
- **–ì–∏–±–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞** - –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –ø—Ä–æ–≤–µ—Ä–æ–∫
- **Docker** - –ì–æ—Ç–æ–≤—ã–π –æ–±—Ä–∞–∑ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **Remnawave Panel** —Å –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–º–∏ –Ω–æ–¥–∞–º–∏
- **Remnawave API Token** - –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –ø–∞–Ω–µ–ª–∏
- **Cloudflare** —Å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º–∏ DNS-–∑–æ–Ω–∞–º–∏
- **Cloudflare API Token** - —Å –ø—Ä–∞–≤–∞–º–∏ –Ω–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ DNS

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ [`.env.example`](.env.example) –≤ `.env`:

```env
# Remnawave
REMNAWAVE_API_URL=https://panel.example.com
REMNAWAVE_API_KEY=remnawave_api_key

# Cloudflare (—Ç–æ–∫–µ–Ω —Å –ø—Ä–∞–≤–∞–º–∏ DNS Edit)
CLOUDFLARE_API_TOKEN=cloudflare_api_token

# Telegram (—Ç–æ–∫–µ–Ω –æ—Ç @BotFather)
TELEGRAM_BOT_TOKEN=your_bot_token_here
# Chat ID (—É–∑–Ω–∞—Ç—å —á–µ—Ä–µ–∑ @username_to_id_bot)
TELEGRAM_CHAT_ID=123456789
# ID —Ç–æ–ø–∏–∫–∞ (–¥–ª—è —Ñ–æ—Ä—É–º–æ–≤, –∏–Ω–∞—á–µ –æ—Å—Ç–∞–≤–∏—Ç—å –ø—É—Å—Ç—ã–º)
TELEGRAM_TOPIC_ID=

# –ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å –∏ —Ñ–æ—Ä–º–∞—Ç –≤—Ä–µ–º–µ–Ω–∏
TIMEZONE=UTC
TIME_FORMAT="%d.%m.%Y %H:%M:%S"
```

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ [`config.example.yml`](config.example.yml) –≤ `config.yml`:

```yaml
remnawave:
  # Health check interval in seconds
  check-interval: 30

# Domains and DNS zones to manage
domains:
  - domain: example1.com
    zones:
      - name: s1          # Creates s1.example1.com
        ttl: 60           # Record TTL in seconds
        proxied: false    # Cloudflare proxy (orange cloud)
        ips:              # Node IPs to monitor
          - 1.2.3.4
          - 5.6.7.8

  - domain: example2.com
    zones:
      - name: s2
        ttl: 60
        proxied: false
        ips:
          - 13.14.15.16
          - 17.18.19.20

logging:
  level: INFO # DEBUG, INFO, WARNING, ERROR, CRITICAL

telegram:
  enabled: false
  locale: en  # en, ru
  notify:
    node_changes: true  # Node online/offline
    dns_changes: true   # DNS record changes
    errors: true        # Error alerts
    critical: true      # All nodes down alert
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è             | –û–ø–∏—Å–∞–Ω–∏–µ                                   | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é      | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ |
|------------------------|--------------------------------------------|-------------------|-------------|
| `REMNAWAVE_API_URL`    | –ê–¥—Ä–µ—Å –ø–∞–Ω–µ–ª–∏ Remnawave                     | -                 | –î–∞          |
| `REMNAWAVE_API_KEY`    | API —Ç–æ–∫–µ–Ω Remnawave                        | -                 | –î–∞          |
| `CLOUDFLARE_API_TOKEN` | API —Ç–æ–∫–µ–Ω Cloudflare (DNS Edit)            | -                 | –î–∞          |
| `TELEGRAM_BOT_TOKEN`   | –¢–æ–∫–µ–Ω –±–æ—Ç–∞ (@BotFather)                    | -                 | –ù–µ—Ç         |
| `TELEGRAM_CHAT_ID`     | ID —á–∞—Ç–∞ –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π                    | -                 | –ù–µ—Ç         |
| `TELEGRAM_TOPIC_ID`    | ID —Ç–æ–ø–∏–∫–∞ (–¥–ª—è —Ñ–æ—Ä—É–º–æ–≤)                    | -                 | –ù–µ—Ç         |
| `TIMEZONE`             | –ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å                               | UTC               | –ù–µ—Ç         |
| `TIME_FORMAT`          | –§–æ—Ä–º–∞—Ç –≤—Ä–µ–º–µ–Ω–∏                             | %d.%m.%Y %H:%M:%S | –ù–µ—Ç         |
| `check-interval`       | –ò–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏ (—Å–µ–∫)                    | 30                | –ù–µ—Ç         |
| `logging.level`        | –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–æ–≤                              | INFO              | –ù–µ—Ç         |

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### Docker (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. –°–æ–∑–¥–∞–π—Ç–µ `docker-compose.yml`:

```yaml
services:
  remnawave-cloudflare-nodes:
    image: hteppl/remnawave-cloudflare-nodes:latest
    container_name: remnawave-cloudflare-nodes
    restart: unless-stopped
    env_file:
      - .env
    volumes:
      - ./config.yml:/app/config.yml:ro
      - ./logs:/app/logs
    logging:
      driver: json-file
      options:
        max-size: "20m"
        max-file: "3"
```

2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ `.env`:

```bash
cp .env.example .env
nano .env
```

3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ:

```bash
docker compose up -d && docker compose logs -f
```

### –†—É—á–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
git clone https://github.com/hteppl/remnawave-cloudflare-nodes.git
cd remnawave-cloudflare-nodes

python -m venv .venv
source .venv/bin/activate  # Linux/macOS
# .venv\Scripts\activate   # Windows

pip install -r requirements.txt
cp .env.example .env
python -m src
```

## –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã

1. **–ó–∞–ø—É—Å–∫** - –°–µ—Ä–≤–∏—Å –ø–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –Ω–æ–¥ –∏–∑ Remnawave –∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç Zone ID –≤ Cloudflare

2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è** - –ù–æ–¥–∞ —Å—á–∏—Ç–∞–µ—Ç—Å—è —Ä–∞–±–æ—á–µ–π, –µ—Å–ª–∏:
   - `is_connected = true`
   - `is_disabled = false`
   - `xray_version` –Ω–µ –ø—É—Å—Ç–æ–π

3. **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è DNS**:
   - –î–æ–±–∞–≤–ª—è–µ—Ç A-–∑–∞–ø–∏—Å–∏ –¥–ª—è —Ä–∞–±–æ—á–∏—Ö –Ω–æ–¥
   - –£–¥–∞–ª—è–µ—Ç A-–∑–∞–ø–∏—Å–∏ –¥–ª—è –Ω–µ—Ä–∞–±–æ—á–∏—Ö –Ω–æ–¥

4. **–¶–∏–∫–ª** - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ `check-interval` —Å–µ–∫—É–Ω–¥

## Telegram-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

–°–µ—Ä–≤–∏—Å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Å–æ–±—ã—Ç–∏—è—Ö –≤ Telegram.

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

1. –°–æ–∑–¥–∞–π—Ç–µ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ [@BotFather](https://t.me/BotFather)
2. –£–∑–Ω–∞–π—Ç–µ —Å–≤–æ–π chat ID —á–µ—Ä–µ–∑ [@username_to_id_bot](https://t.me/username_to_id_bot)
3. –î–æ–±–∞–≤—å—Ç–µ –±–æ—Ç–∞ –≤ —á–∞—Ç
4. –£–∫–∞–∂–∏—Ç–µ —Ç–æ–∫–µ–Ω –∏ chat ID –≤ `.env`
5. –í–∫–ª—é—á–∏—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ `config.yml`:

```yaml
telegram:
  enabled: true
  locale: ru
```

### –¢–∏–ø—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

| –°–æ–±—ã—Ç–∏–µ          | –û–ø–∏—Å–∞–Ω–∏–µ            | –ü—Ä–∏–º–µ—Ä                                                                          |
|------------------|---------------------|---------------------------------------------------------------------------------|
| **–ù–æ–¥–∞ –æ–Ω–ª–∞–π–Ω**  | –ù–æ–¥–∞ –¥–æ—Å—Ç—É–ø–Ω–∞       | ‚úÖ –ù–æ–¥–∞ –æ–Ω–ª–∞–π–Ω<br>node-1 (1.2.3.4) –¥–æ—Å—Ç—É–ø–Ω–∞.<br>üìä –ù–æ–¥—ã: 5/6 –æ–Ω–ª–∞–π–Ω, 0 –æ—Ç–∫–ª—é—á–µ–Ω–æ |
| **–ù–æ–¥–∞ –æ—Ñ–ª–∞–π–Ω**  | –ù–æ–¥–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞     | ‚ùå –ù–æ–¥–∞ –æ—Ñ–ª–∞–π–Ω<br>node-1 (1.2.3.4) –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞.<br>–ü—Ä–∏—á–∏–Ω–∞: disconnected          |
| **DNS –¥–æ–±–∞–≤–ª–µ–Ω** | –î–æ–±–∞–≤–ª–µ–Ω–∞ A-–∑–∞–ø–∏—Å—å  | üìù DNS –æ–±–Ω–æ–≤–ª—ë–Ω<br>–î–æ–±–∞–≤–ª–µ–Ω 1.2.3.4 ‚Üí s1.example.com                            |
| **DNS —É–¥–∞–ª—ë–Ω**   | –£–¥–∞–ª–µ–Ω–∞ A-–∑–∞–ø–∏—Å—å    | üóëÔ∏è DNS —É–¥–∞–ª—ë–Ω<br>–£–¥–∞–ª—ë–Ω 1.2.3.4 –∏–∑ s1.example.com                              |
| **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è**  | –í—Å–µ –Ω–æ–¥—ã –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã | üî¥ –ö–†–ò–¢–ò–ß–ù–û: –í—Å–µ –Ω–æ–¥—ã –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã                                                |
| **–ó–∞–ø—É—Å–∫**       | –°–µ—Ä–≤–∏—Å –∑–∞–ø—É—â–µ–Ω      | üöÄ –°–µ—Ä–≤–∏—Å –∑–∞–ø—É—â–µ–Ω                                                               |
| **–û—Å—Ç–∞–Ω–æ–≤–∫–∞**    | –°–µ—Ä–≤–∏—Å –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω   | üõë –°–µ—Ä–≤–∏—Å –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω                                                            |

### –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

```yaml
telegram:
  enabled: true
  locale: ru
  notify:
    node_changes: true  # –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –Ω–æ–¥
    dns_changes: true   # –∏–∑–º–µ–Ω–µ–Ω–∏—è DNS
    errors: true        # –æ—à–∏–±–∫–∏
    critical: true      # –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–±—ã—Ç–∏—è
```

### –õ–æ–≥–∏

```bash
# Docker
docker compose logs -f

# –†—É—á–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞
# stdout + logs/app.log
```

## –õ–∏—Ü–µ–Ω–∑–∏—è

[GNU General Public License v3.0](LICENSE)
